<div  class="w-[100%] bg-white h-auto p-2 pt-4 pl-4">
  <div class="header-order p-2 border-b-2">
    <span class="font-medium text-[20px]">Phiếu tư vấn của tôi</span><br>
    <span class="text-gray-500 text-sm">Hiển thị thông tin các câu hỏi của bạn tại Penguin hospital</span>
  </div>
  <div class="body-header-order p-2 border-b-2 ">
    <form action="" class="flex items-center justify-between">
      <div class="flex">
        <div class="p-2">
          <input type="text" placeholder="mã phiếu câu hỏi" class="p-2 rounded-lg border-2">
        </div>
        <div class="p-2">
          <input type="text" placeholder="tên câu hỏi" class="p-2 rounded-lg border-2">
        </div>
      </div>
      <div class="flex space-x-2">
        <button type="button" (click)="tradeQuestionForm()" class="p-2 text-blue-600 text-sm text-center bg-white border-2 rounded-lg flex items-center justify-center">Tạo câu hỏi</button>
        <button type="button" (click)="showSuccessMessage()" class="p-2 text-white text-sm text-center bg-blue-600 rounded-lg flex items-center justify-center hover:bg-blue-500">Tìm kiếm</button>
      </div>
    </form>
  </div>
  <div class="table-order p-2">
    <table class="w-full mt-2 rounded-lg mb-4 border">
      <thead class="border-gray-200">
        <tr class="">
          <th class="font-medium text-black p-2 text-start">Mã câu hỏi</th>
          <th class="font-medium text-black p-2 text-start">Tên Câu hỏi</th>
          <th class="font-medium text-black p-2 text-start">Nội dung</th>
          <th class="font-medium text-black p-2 text-start">Trạng thái</th>
          <th class="font-medium text-black p-2 text-start"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100 overflow-y-auto">
        <tr *ngFor="let item of questionOutPut">
          <th class="text-gray-500 text-sm font-semibold text-start p-2">{{item.codeQuestion}}</th>
          <th class="text-gray-500 text-sm font-semibold text-start p-2">{{item.title}}</th>
          <th class="text-gray-500 text-sm font-semibold text-start p-2 truncate max-w-xs">{{item.content}}</th>
          <th class="text-gray-500 text-sm font-semibold text-start p-2">{{item.statusQuestion}}</th>
          <th class="text-blue-500 text-sm font-semibold text-start p-2 ">
            <button (click)="detailQuestion(item.id)">
              <span class="underline">chi tiết</span>
            </button>
          </th>
        </tr>
      </tbody>
    </table>
    <div class="flex w-[100%] items-center justify-end space-x-4">
      <button class="hover:bg-gray-500 p-1">Trở lại</button>
      <button class="hover:bg-gray-500 p-1 rounded-lg">1</button>
      <button class="hover:bg-gray-500 p-1 rounded-lg">2</button>
      <button class="hover:bg-gray-500 p-1 rounded-lg">3</button>
      <button class="hover:bg-gray-500 p-1">Tiếp tục</button>
    </div>
  </div>
</div>

<div class="modal fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 z-50 flex items-center justify-center" *ngIf="showQuestionForm">
  <div class="w-[50%] h-auto bg-yellow-100 p-2 pb-4">
    <div class="w-[100%] flex items-center justify-end">
      <button class="transition-transform duration-300 hover:scale-105" (click)="tradeQuestionForm()">
        <svg class="w-7 h-7" fill="#b85b2f" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" stroke="#b85b2f"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>cancel</title> <path d="M10.771 8.518c-1.144 0.215-2.83 2.171-2.086 2.915l4.573 4.571-4.573 4.571c-0.915 0.915 1.829 3.656 2.744 2.742l4.573-4.571 4.573 4.571c0.915 0.915 3.658-1.829 2.744-2.742l-4.573-4.571 4.573-4.571c0.915-0.915-1.829-3.656-2.744-2.742l-4.573 4.571-4.573-4.571c-0.173-0.171-0.394-0.223-0.657-0.173v0zM16 1c-8.285 0-15 6.716-15 15s6.715 15 15 15 15-6.716 15-15-6.715-15-15-15zM16 4.75c6.213 0 11.25 5.037 11.25 11.25s-5.037 11.25-11.25 11.25-11.25-5.037-11.25-11.25c0.001-6.213 5.037-11.25 11.25-11.25z"></path> </g></svg>
      </button>
    </div>
    <div class="header-title-details-appointment w-[100%] flex items-center justify-center p-2">
      <div class="w-[40%] h-[120px] flex flex-col items-end justify-center pr-2 border-r-2">
        <span class="font-sans text-[25px] text-[#b85b2f]">Phóng khám</span>
        <span class="font-sans text-[25px] text-[#b85b2f]">Thú ý Penguin</span>
      </div>
      <div class="w-[40%] flex items-center justify-start pl-2">
          <img src="http://localhost:8080/uploads/222bf6eb-aa92-4d59-b687-55d760597b5a_Screenshot%202024-11-13%20021405.png" alt="" class="w-[120px] h-[120px]">
      </div>
    </div>
    <div class="body-title-details-appointment w-[100%] flex flex-items justify-center">
      <div class="w-[80%]">
        <form [formGroup]="formQuestion" (ngSubmit)="onSubmit()">
          <div class="w-[100%] p-2 flex flex-col items-center">
            <label for="" class="font-bold text-[#b85b2f] text-[20px]">PHIẾU CÂU HỎI</label>
          </div>
          <div class="w-[100%] p-2 flex">
            <span class="bg-white p-2 text-[14px] w-[25%]"><span class="text-[#b85b2f]">Tiêu đề câu hỏi:</span> </span>
            <input formControlName="title" type="text" class="w-[75%] focus:outline-none ">
          </div>
          <div class="w-[100%] p-2 flex items-center justify-center space-x-2">
            <div class="bg-white p-2 text-[14px] w-[50%] flex">
              <span class="w-[40%]"><span class="text-[#b85b2f]">Chọn người hỏi:</span></span>
              <select formControlName="doctorId" class="w-[60%] rounded-lg focus:outline-none" name="" id="">
                <option value="default" disabled >
                  Chọn bác sĩ
                </option>
                <option *ngFor="let doctor of doctorArray" [value]="doctor.id">
                  {{doctor.fullName}}
                </option>
              </select>
            </div>

            <div class="bg-white p-2 text-[14px] w-[50%] flex">
              <span class="w-[40%]"><span class="text-[#b85b2f]">Loại câu hỏi:</span></span>
              <select formControlName="typeQuestion" class="w-[60%] rounded-lg focus:outline-none" name="" id="">
                <option value="default" class=" rounded-lg focus:outline-none">Loại câu hỏi</option>
                <option [value]="item.id" class=" rounded-lg focus:outline-none" *ngFor="let item of typeQuestions">{{item.name}}</option>
              </select>
            </div>
          </div>
          <div class="w-[100%] p-2 flex flex-col">
            <span class="bg-white p-2 text-[14px]"><span class="text-[#b85b2f]">Nội dung:</span></span>
            <textarea formControlName="content" class="focus:outline-none text-[14px] pl-2 pr-2 h-32" name="" id="" cols=""></textarea>
          </div>
          <div class="w-[100%] pt-2 flex items-center justify-center">
            <button type="submit" class="text-[14px] pl-4 pr-4 rounded-lg p-2 font-sans text-white bg-[#b85b2f] active:scale-95 transition-transform duration-150">Gửi</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showSuccess" class="fixed top-14 right-4 bg-white text-white px-4 py-3 rounded-lg shadow-lg transition-opacity duration-500">
  <div class="flex items-center">
    <svg class="w-7 h-7 mr-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#24f547"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M8.5 12.5L10.5 14.5L15.5 9.5" stroke="#24f547" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7" stroke="#24f547" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
    <span class="mr-3 text-[14px] text-black">Phiếu câu hỏi đã được gởi đi!!!</span>
    <div
      class="h-1 bg-green-500 absolute bottom-0 left-0 transition-all"
      [style.width.%]="progressWidth">
    </div>
  </div>
</div>

<div *ngIf="showDetailQuestion" class="modal fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 z-50 flex items-center justify-center">
  <div class="w-[50%] h-[90%] bg-yellow-200 rounded-2xl">
    <div class="border-b-[0.5px] border-gray-500 w-[100%] h-[6%] flex items-center justify-end">
      <button (click)="tradeDetailQuestion()">
        <svg class="w-6 h-6 m-2" fill="#ffffff" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>cancel</title> <path d="M10.771 8.518c-1.144 0.215-2.83 2.171-2.086 2.915l4.573 4.571-4.573 4.571c-0.915 0.915 1.829 3.656 2.744 2.742l4.573-4.571 4.573 4.571c0.915 0.915 3.658-1.829 2.744-2.742l-4.573-4.571 4.573-4.571c0.915-0.915-1.829-3.656-2.744-2.742l-4.573 4.571-4.573-4.571c-0.173-0.171-0.394-0.223-0.657-0.173v0zM16 1c-8.285 0-15 6.716-15 15s6.715 15 15 15 15-6.716 15-15-6.715-15-15-15zM16 4.75c6.213 0 11.25 5.037 11.25 11.25s-5.037 11.25-11.25 11.25-11.25-5.037-11.25-11.25c0.001-6.213 5.037-11.25 11.25-11.25z"></path> </g></svg>
      </button>
    </div>
    <div class="w-[100%] h-[calc(85%)] overflow-auto scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-bg-[#252728]">
      <div class="w-[100%] p-2">
        <div class="w-[100%] flex header items-center justify-between pb-2">
          <div class="w-[50%] flex">
            <img class="w-[40px] h-[40px] rounded-full" src="{{questionDetail.urlUser}}" alt="">
            <div class="flex flex-col items-start">
              <span class="text-[#b85b2f] font-bold text-[14px] pl-2">{{questionDetail.fullName}}</span>
              <span class="text-gray-500 text-[12px] pl-2">17 tháng 11 lúc 6:06</span>
            </div>
          </div>
          <div class="w-[50%] flex items-center justify-end pr-2">
              <button>

                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 7H20" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M6 10L7.70141 19.3578C7.87432 20.3088 8.70258 21 9.66915 21H14.3308C15.2974 21 16.1257 20.3087 16.2986 19.3578L18 10" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
              </button>
          </div>
        </div>
        <div class="w-[100%] body flex flex-col items-center justify-center">
          <div class="w-[80%] border-black border-[0.5px] rounded-2xl">
            <img *ngIf="showImageQuestion" class="h-[400px] w-[100%] object-cover rounded-t-2xl" src="{{questionDetail.urlImage}}" alt="">
            <div class="w-[80%] pt-2 flex">
              <span class="pl-2 pb-2 text-[#b85b2f] font-medium">{{questionDetail.typeQuestion}}</span>
              <svg class="w-6 h-6" fill="#b85b2f" viewBox="-8.5 0 32 32" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff">
                <path d="M0 24.781v-17.594l15.281 8.813z"></path>
              </svg>
              <span class="pl-2 pb-2 text-black  font-medium">{{questionDetail.title}}</span>
            </div>
            <div class="w-[80%] pb-2 pl-4">
              <span class="text-black text-[14px]">{{questionDetail.content}}</span>
            </div>
          </div>
        </div>
        <div class="w-[100%] comment flex items-center justify-center pt-4">
          <div class="w-[80%] border-t-[1px] border-black border-b-[1px]">
            <button class="flex hover:bg-gray-500 m-1 pr-1 pl-1 rounded-md">
              <svg class="w-6 h-6 mt-1 mb-1"  viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>comment-4</title> <desc>Created with Sketch Beta.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> <g id="Icon-Set" sketch:type="MSLayerGroup" transform="translate(-308.000000, -255.000000)" fill="#000000"> <path d="M327.494,279.633 L324,284 L320.506,279.633 C314.464,278.355 309.992,273.863 309.992,268.501 C309.992,262.146 316.264,256.994 324,256.994 C331.736,256.994 338.008,262.146 338.008,268.501 C338.008,273.863 333.536,278.355 327.494,279.633 L327.494,279.633 Z M324,255 C315.163,255 308,261.143 308,268.72 C308,274.969 312.877,280.232 319.542,281.889 L324,287.001 L328.459,281.889 C335.123,280.232 340,274.969 340,268.72 C340,261.143 332.837,255 324,255 L324,255 Z" id="comment-4" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg>
              <span class="text-black pb-1 pt-1 pl-1 text-[14px]">Bình luận</span>
            </button>
          </div>
        </div>
        <div class="w-[100%] comment flex items-center justify-center pt-2" *ngFor="let item of commentParen">
          <div class="w-[80%] comment-cha">
            <div class="w-[100%] flex space-x-2 mt-2">
              <img class="w-[32px] h-[32px] object-cover rounded-full" src="{{item.urlImageUser}}" alt="">
              <div class="w-[90%]">
                <div class="w-auto bg-yellow-100 rounded-2xl p-2 flex flex-col">
                  <span class="text-[12px] font-medium text-[#b85b2f]">{{item.nameUser}}</span>
                  <span class="text-[12px] font-medium text-black">{{item.content}}</span>
                </div>
                <div class="w-[100%]">
                  <button (click)="toggleChildComment(item)" class="text-[12px] font-medium text-gray-500">Trả lời</button>
                  <div *ngIf="item.showChildComment" class="w-[100%] space-x-2 flex items-center justify-center">
                    <img class="w-[34px] h-[34px] rounded-full" src="{{avatar}}" alt="">
                    <div class="w-[90%]">
                      <input [(ngModel)]="contentChildren" (keyup.enter)=" createCommentChildren(item.id,questionDetail.id)" class="w-[100%] p-1.5 text-sm text-white outline-none rounded-lg bg-[#333334] pl-2" type="text" placeholder="Vui lòng nhập bình luận">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-[80%]" *ngFor="let commentChildren of item.listCommentChild">
              <div class="w-[100%] pl-10 flex space-x-2 mt-2">
                <img class="w-[32px] h-[32px] object-cover rounded-full" src="{{commentChildren.urlUser}}" alt="">
                <div class="w-auto bg-yellow-100 rounded-2xl p-2 flex flex-col">
                  <span class="text-[12px] font-medium text-[#b85b2f]">{{commentChildren.nameUser}}</span>
                  <span class="text-[12px] font-medium text-black">{{commentChildren.content}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
    <div class="w-[100%] comment flex items-center justify-center ">
      <div class="w-[100%] flex p-2 items-center space-x-2">
        <img class="w-[32px] h-[32px] object-cover rounded-2xl" src="{{avatar}}" alt="">
        <div class="comment w-[90%] pt-2 pb-2 flex items-center justify-center bg-yellow-100 rounded-lg">
          <input (keyup.enter)="createCommentQuestion(questionDetail.id)" [(ngModel)]="content" type="text" class="w-[100%] bg-yellow-100 outline-none p-1 pl-3 text-sm text-white rounded-2xl" placeholder="trả lời bình luận">
          <button (click)="createCommentQuestion(questionDetail.id)">
            <svg class="w-6 h-6 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M11.5003 12H5.41872M5.24634 12.7972L4.24158 15.7986C3.69128 17.4424 3.41613 18.2643 3.61359 18.7704C3.78506 19.21 4.15335 19.5432 4.6078 19.6701C5.13111 19.8161 5.92151 19.4604 7.50231 18.7491L17.6367 14.1886C19.1797 13.4942 19.9512 13.1471 20.1896 12.6648C20.3968 12.2458 20.3968 11.7541 20.1896 11.3351C19.9512 10.8529 19.1797 10.5057 17.6367 9.81135L7.48483 5.24303C5.90879 4.53382 5.12078 4.17921 4.59799 4.32468C4.14397 4.45101 3.77572 4.78336 3.60365 5.22209C3.40551 5.72728 3.67772 6.54741 4.22215 8.18767L5.24829 11.2793C5.34179 11.561 5.38855 11.7019 5.407 11.8459C5.42338 11.9738 5.42321 12.1032 5.40651 12.231C5.38768 12.375 5.34057 12.5157 5.24634 12.7972Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
